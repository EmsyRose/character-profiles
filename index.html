<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Character Profiles</title>
  <meta name="description" content="Browse character profiles and read their stories." />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg: #0b0e14;
      --panel: #11151f;
      --panel-2: #0f1420;
      --text: #e6eaf2;
      --muted: #a9b0bf;
      --brand: #6aa0ff;
      --brand-2: #8bc7ff;
      --ok: #5bd993;
      --warn: #ffcc66;
      --danger: #ff6a7a;
      --ring: 0 0 0 3px rgba(106,160,255,.35);
      --radius: 14px;
      --shadow: 0 8px 30px rgba(0,0,0,.35);
    }
    [data-theme="light"] {
      --bg: #f7f8fb;
      --panel: #ffffff;
      --panel-2: #f2f5fb;
      --text: #101318;
      --muted: #556070;
      --brand: #375dfb;
      --brand-2: #6aa0ff;
      --ok: #0a8f5d;
      --warn: #a26b00;
      --danger: #b7263a;
      --ring: 0 0 0 3px rgba(55,93,251,.25);
      --shadow: 0 8px 30px rgba(16,19,24,.08);
    }

    /* Reset-ish */
    *, *::before, *::after { box-sizing: border-box; }
    html, body { height: 100%; }
    body {
      margin: 0;
      font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
      background: radial-gradient(1200px 800px at 60% -20%, rgba(106,160,255,.20), transparent 60%) , var(--bg);
      color: var(--text);
      line-height: 1.55;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }
    a { color: inherit; text-decoration: none; }
    img { max-width: 100%; display: block; }

    /* Layout */
    .container {
      max-width: 1100px;
      margin: 0 auto;
      padding: 24px;
    }
    header {
      display: grid;
      gap: 12px;
      grid-template-columns: 1fr auto;
      align-items: center;
      margin-bottom: 14px;
    }
    .title {
      font-weight: 800;
      letter-spacing: .3px;
      font-size: clamp(22px, 3.3vw, 32px);
    }
    .subtitle {
      color: var(--muted);
      font-size: 14px;
      margin-top: -6px;
    }
    .toolbar {
      display: flex;
      gap: 8px;
      align-items: center;
      justify-content: flex-end;
    }
    .btn, .chip {
      border: 1px solid transparent;
      background: linear-gradient(180deg, var(--panel), var(--panel-2));
      padding: 10px 14px;
      border-radius: 10px;
      color: var(--text);
      box-shadow: var(--shadow);
    }
    .btn {
      display: inline-flex; align-items: center; gap: 10px; cursor: pointer; font-weight: 600;
    }
    .btn:focus-visible { outline: none; box-shadow: var(--ring); }
    .btn.primary { border-color: rgba(106,160,255,.35); }
    .btn.ghost { background: transparent; border-color: rgba(255,255,255,.1); box-shadow: none; }
    .icon { width: 18px; height: 18px; display: inline-block; }

    /* Search + tags */
    .filters {
      display: grid;
      grid-template-columns: minmax(0,1fr);
      gap: 12px;
      margin: 12px 0 22px;
    }
    .search {
      display: grid; grid-template-columns: auto 1fr auto; align-items: center; gap: 10px;
      padding: 12px 14px; border-radius: var(--radius);
      background: linear-gradient(180deg, var(--panel), var(--panel-2));
      border: 1px solid rgba(255,255,255,.08);
      box-shadow: var(--shadow);
    }
    .search input {
      background: transparent; border: 0; color: var(--text); font-size: 15px; outline: none;
    }
    .search input::placeholder { color: var(--muted); }
    .tag-bar { display: flex; flex-wrap: wrap; gap: 8px; }
    .chip[aria-pressed="true"] { border-color: var(--brand-2); background: rgba(106,160,255,.12); }

    /* Grid */
    .grid {
      display: grid;
      grid-template-columns: repeat(12, 1fr);
      gap: 16px;
    }
    @media (max-width: 920px) { .grid { grid-template-columns: repeat(8, 1fr); } }
    @media (max-width: 640px) { .grid { grid-template-columns: repeat(4, 1fr); } }

    .card {
      grid-column: span 4;
      background: linear-gradient(180deg, var(--panel), var(--panel-2));
      border: 1px solid rgba(255,255,255,.08);
      border-radius: var(--radius);
      overflow: hidden;
      display: grid;
      grid-template-rows: 190px auto;
      transition: transform .2s ease, box-shadow .2s ease;
    }
    .card:hover { transform: translateY(-3px); box-shadow: 0 14px 40px rgba(0,0,0,.45); }
    .thumb { aspect-ratio: 16/10; background: #0a0e15; display: grid; place-items: center; overflow: hidden; }
    .thumb img { width: 100%; height: 100%; object-fit: cover; }
    .content { padding: 14px 14px 16px; }
    .name { font-weight: 700; font-size: 18px; }
    .alias { color: var(--muted); font-size: 13px; margin-top: 2px; }
    .tags { display: flex; flex-wrap: wrap; gap: 6px; margin-top: 10px; }
    .tag { font-size: 12px; padding: 5px 8px; border-radius: 8px; background: rgba(255,255,255,.06); border: 1px solid rgba(255,255,255,.08); color: var(--muted); }

    /* Detail view */
    .detail {
      display: none;
      background: linear-gradient(180deg, var(--panel), var(--panel-2));
      border: 1px solid rgba(255,255,255,.08);
      border-radius: var(--radius);
      overflow: clip;
      grid-template-columns: 360px 1fr;
      gap: 0;
      box-shadow: var(--shadow);
      margin-top: 10px;
    }
    .detail.show { display: grid; }
    @media (max-width: 860px) { .detail { grid-template-columns: 1fr; } }
    .detail .cover { background: #0a0e15; height: 100%; }
    .detail .cover img { width: 100%; height: 100%; object-fit: cover; }
    .detail .body { padding: 18px; }
    .breadcrumbs { font-size: 13px; color: var(--muted); margin-bottom: 6px; }
    .detail h1 { margin: 6px 0 6px; font-size: clamp(22px, 3vw, 28px); }
    .meta { display: flex; flex-wrap: wrap; gap: 10px; margin: 8px 0 14px; }
    .pill { padding: 6px 10px; border-radius: 999px; border: 1px solid rgba(255,255,255,.08); background: rgba(255,255,255,.06); font-size: 12px; color: var(--muted); }
    .bio { font-size: 15px; }
    .kv {
      margin-top: 18px; display: grid; gap: 8px;
      grid-template-columns: repeat(2, minmax(0,1fr));
    }
    @media (max-width: 640px) { .kv { grid-template-columns: 1fr; } }
    .kv-item { background: rgba(255,255,255,.05); border: 1px solid rgba(255,255,255,.08); border-radius: 10px; padding: 10px 12px; }
    .kv-item .k { font-size: 12px; color: var(--muted); }
    .kv-item .v { font-weight: 600; }

    footer {
      margin: 32px 0 20px; color: var(--muted); font-size: 13px; text-align: center;
    }

    /* Accessibility helpers */
    .sr-only {
      position: absolute; width: 1px; height: 1px; padding: 0; margin: -1px; overflow: hidden; clip: rect(0,0,0,0); white-space: nowrap; border: 0;
    }

  </style>
</head>
<body>
  <div class="container" id="app">
    <header>
      <div>
        <div class="title">Character Profiles</div>
        <div class="subtitle">Click a card to read more. Use the search and tags to filter.</div>
      </div>
      <div class="toolbar">
        <button class="btn ghost" id="themeToggle" aria-pressed="false" title="Toggle theme">
          <span aria-hidden="true" class="icon">üåì</span> Theme
        </button>
        <a class="btn primary" href="#/" id="homeBtn" title="Home">
          <span aria-hidden="true" class="icon">üè†</span> Home
        </a>
      </div>
    </header>

    <section class="filters" aria-label="Filters">
      <div class="search" role="search">
        <span aria-hidden="true">üîé</span>
        <input id="searchInput" type="search" placeholder="Search by name, alias, or bio‚Ä¶" autocomplete="off" />
        <button class="btn ghost" id="clearSearch" title="Clear search">Clear</button>
      </div>
      <div class="tag-bar" id="tagBar" role="toolbar" aria-label="Tag filters"></div>
    </section>

    <!-- List (grid) view -->
    <section id="listView" class="grid" aria-live="polite" aria-busy="false"></section>

    <!-- Detail view -->
    <article id="detailView" class="detail" aria-live="polite" aria-busy="false">
      <div class="cover"><img id="detailImg" alt=""></div>
      <div class="body">
        <nav class="breadcrumbs"><a href="#/">Characters</a> / <span id="crumbName"></span></nav>
        <h1 id="detailName">Name</h1>
        <div class="meta">
          <span class="pill" id="detailAlias"></span>
          <span class="pill" id="detailStatus"></span>
        </div>
        <div class="tags" id="detailTags"></div>
        <p class="bio" id="detailBio"></p>

        <div class="kv" id="detailKV"></div>
      </div>
    </article>

    <footer>Built with vanilla HTML, CSS & JS. Customize the data below in the file.</footer>
  </div>

  <script>
    /**
     * =========================
     * Quick customization guide
     * =========================
     * 1) Add your images to /images and update the `image` fields below.
     * 2) Edit the `CHARACTERS` array to add/remove characters.
     * 3) Optional: Change colors in the :root CSS variables.
     * 4) Link directly to a character with: https://YOUR-USER.github.io/REPO/#/character/<slug>
     */

    /** -------------------------------------------
     * Sample data ‚Äî replace with your own!
     * Fields are free-form; keep keys you need.
     * ------------------------------------------- */
    const CHARACTERS = [
      {
        id: "aran-wilder",
        name: "Aran Wilder",
        alias: "The Last Cartographer",
        image: "images/aran.jpg",
        status: "Alive",
        tags: ["Explorer", "Cartographer", "Human"],
        bio: "A relentless explorer who maps places that refuse to stay put. Aran anchors drifting islands by naming them.",
        stats: { Age: "31", Origin: "Northreach", Affiliation: "Sky Survey", "First appearance": "Ch. 02" }
      },
      {
        id: "sable-nyx",
        name: "Sable Nyx",
        alias: "Whisper of Glass",
        image: "images/sable.jpg",
        status: "Unknown",
        tags: ["Assassin", "Rogue", "Elf"],
        bio: "Sable speaks in reflections‚Äîrumored to step between mirrors. Hired blade with a personal code.",
        stats: { Age: "???", Origin: "The Seam", Affiliation: "None", "First appearance": "Ch. 05" }
      },
      {
        id: "kaio-ventris",
        name: "Kaio Ventris",
        alias: "Stormcaller",
        image: "images/kaio.jpg",
        status: "Deceased",
        tags: ["Mage", "Scholar", "Human"],
        bio: "A scholar whose weatherwork saved a city‚Äîand broke its river. Their journals are sealed.",
        stats: { Age: "48", Origin: "Hallowmere", Affiliation: "Azure Collegium", "First appearance": "Ch. 01" }
      }
    ];

    /** Utility: slugify a string to use in URLs */
    const slugify = s => s.toLowerCase().replace(/[^a-z0-9]+/g,'-').replace(/(^-|-$)/g,'');

    /** Collect unique tags from data */
    function collectTags(data) {
      const set = new Set();
      data.forEach(c => (c.tags || []).forEach(t => set.add(t)));
      return [...set].sort((a,b)=>a.localeCompare(b));
    }

    /** Render tag bar with toggleable chips */
    function renderTagBar(tags) {
      const bar = document.getElementById('tagBar');
      bar.innerHTML = '';
      tags.forEach(tag => {
        const b = document.createElement('button');
        b.className = 'chip';
        b.type = 'button';
        b.setAttribute('aria-pressed','false');
        b.textContent = tag;
        b.addEventListener('click', () => {
          const active = b.getAttribute('aria-pressed') === 'true';
          b.setAttribute('aria-pressed', String(!active));
          updateList();
        });
        bar.appendChild(b);
      });

      // Also add a "Clear tags" chip if there are tags
      if (tags.length) {
        const clear = document.createElement('button');
        clear.className = 'chip';
        clear.type = 'button';
        clear.textContent = 'Clear tags';
        clear.addEventListener('click', () => {
          [...bar.querySelectorAll('.chip[aria-pressed="true"]')].forEach(c => c.setAttribute('aria-pressed','false'));
          updateList();
        });
        bar.appendChild(clear);
      }
    }

    /** Filter logic */
    function getActiveTags() {
      return [...document.querySelectorAll('#tagBar .chip[aria-pressed="true"]')].map(b => b.textContent);
    }
    function matchesFilters(character, term, activeTags) {
      const text = (character.name + ' ' + (character.alias||'') + ' ' + (character.bio||'')).toLowerCase();
      const searchOk = !term || text.includes(term);
      const tagsOk = !activeTags.length || activeTags.every(t => (character.tags||[]).includes(t));
      return searchOk && tagsOk;
    }

    /** Render grid */
    function renderList(data) {
      const grid = document.getElementById('listView');
      grid.innerHTML = '';

      if (!data.length) {
        const empty = document.createElement('div');
        empty.style.gridColumn = '1 / -1';
        empty.innerHTML = `<div class="card" style="grid-column: 1/-1; text-align:center; padding:24px; display:block;">
          <div class="content">
            <div class="name">No characters match your filters.</div>
            <div class="alias">Try clearing search or tags.</div>
          </div>
        </div>`;
        grid.appendChild(empty);
        return;
      }

      for (const c of data) {
        const a = document.createElement('a');
        a.href = `#/character/${c.id || slugify(c.name)}`;
        a.className = 'card';
        a.setAttribute('aria-label', `Open profile for ${c.name}`);
        a.innerHTML = `
          <div class="thumb">${c.image ? `<img src="${c.image}" alt="">` : `<span style="color:var(--muted)">No image</span>`}</div>
          <div class="content">
            <div class="name">${escapeHTML(c.name)}</div>
            ${c.alias ? `<div class="alias">${escapeHTML(c.alias)}</div>` : ''}
            <div class="tags">${(c.tags||[]).slice(0,4).map(t=>`<span class="tag">${escapeHTML(t)}</span>`).join('')}</div>
          </div>`;
        grid.appendChild(a);
      }
    }

    /** Escape HTML (basic) */
    function escapeHTML(s) {
      return String(s).replace(/[&<>"']/g, m => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m]));
    }

    /** Detail view rendering */
    function renderDetail(c) {
      const detail = document.getElementById('detailView');
      if (!c) {
        detail.classList.remove('show');
        detail.setAttribute('aria-busy', 'false');
        return;
      }
      document.getElementById('crumbName').textContent = c.name;
      document.getElementById('detailName').textContent = c.name;
      document.getElementById('detailAlias').textContent = c.alias || '';
      document.getElementById('detailAlias').style.display = c.alias ? 'inline-block' : 'none';
      const status = document.getElementById('detailStatus');
      status.textContent = c.status || '';
      status.style.display = c.status ? 'inline-block' : 'none';

      const tags = document.getElementById('detailTags');
      tags.innerHTML = (c.tags||[]).map(t=>`<span class="tag">${escapeHTML(t)}</span>`).join('');

      const img = document.getElementById('detailImg');
      if (c.image) { img.src = c.image; img.alt = `${c.name} ‚Äî portrait`; }
      else { img.removeAttribute('src'); img.alt = ''; }

      document.getElementById('detailBio').textContent = c.bio || '';

      const kv = document.getElementById('detailKV');
      kv.innerHTML = '';
      const entries = c.stats ? Object.entries(c.stats) : [];
      for (const [k,v] of entries) {
        const div = document.createElement('div');
        div.className = 'kv-item';
        div.innerHTML = `<div class="k">${escapeHTML(k)}</div><div class="v">${escapeHTML(v)}</div>`;
        kv.appendChild(div);
      }

      detail.classList.add('show');
      detail.scrollIntoView({behavior:'smooth', block:'start'});
    }

    /** Router */
    function parseHash() {
      const h = location.hash || '#/';
      const parts = h.slice(2).split('/'); // remove "#/"
      const route = parts[0] || '';
      const param = parts[1] || '';
      return { route, param };
    }

    function navigate() {
      const { route, param } = parseHash();
      const list = document.getElementById('listView');
      const detail = document.getElementById('detailView');

      if (route === 'character' && param) {
        list.style.display = 'none';
        const who = CHARACTERS.find(c => (c.id || slugify(c.name)) === param);
        renderDetail(who);
        if (!who) {
          // simple 404 inside detail container
          detail.classList.add('show');
          detail.querySelector('.body').innerHTML = `
            <nav class="breadcrumbs"><a href="#/">Characters</a> / <span>Not found</span></nav>
            <h1>Character not found</h1>
            <p class="bio">We couldn't find a character with id "<code>${escapeHTML(param)}</code>".</p>
          `;
        }
      } else {
        detail.classList.remove('show');
        list.style.display = '';
        updateList();
      }
    }

    /** Search + filter binding */
    const searchInput = document.getElementById('searchInput');
    const clearBtn = document.getElementById('clearSearch');

    function updateList() {
      const term = searchInput.value.trim().toLowerCase();
      const activeTags = getActiveTags();
      const filtered = CHARACTERS.filter(c => matchesFilters(c, term, activeTags));
      renderList(filtered);
    }

    clearBtn.addEventListener('click', () => {
      searchInput.value = '';
      updateList();
      searchInput.focus();
    });
    searchInput.addEventListener('input', updateList);

    /** Theme toggle (saved in localStorage) */
    const root = document.documentElement;
    const THEME_KEY = 'character-theme';
    const themeToggle = document.getElementById('themeToggle');
    function applyTheme(t) {
      if (t === 'light') root.setAttribute('data-theme','light');
      else root.removeAttribute('data-theme');
      themeToggle.setAttribute('aria-pressed', t === 'light' ? 'true' : 'false');
    }
    const saved = localStorage.getItem(THEME_KEY);
    applyTheme(saved || 'dark');
    themeToggle.addEventListener('click', () => {
      const isLight = root.getAttribute('data-theme') === 'light';
      const next = isLight ? 'dark' : 'light';
      applyTheme(next);
      localStorage.setItem(THEME_KEY, next);
    });

    /** Init */
    renderTagBar(collectTags(CHARACTERS));
    renderList(CHARACTERS);
    window.addEventListener('hashchange', navigate);
    navigate();

    // Keyboard: open first visible card with Enter from search
    searchInput.addEventListener('keydown', (e) => {
      if (e.key === 'Enter') {
        const first = document.querySelector('.grid .card');
        if (first) first.focus ? first.focus() : (location.href = first.getAttribute('href'));
      }
    });

    // Preload sample images if missing to avoid broken layout (optional)
    // You can delete this block once you add real images.
    for (const c of CHARACTERS) {
      if (!c.image) continue;
      const img = new Image();
      img.src = c.image;
    }
  </script>
</body>
</html>
